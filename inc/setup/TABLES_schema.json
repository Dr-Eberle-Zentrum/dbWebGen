{
    "title": "Tables Settings",
    "description": "For each table that you want users be able to view or edit in the app, configure the relevant fields.",
    "type": "array",
    "items": {
        "type": "object",
        "title": "Table",
        "description": "Provide settings for the table",
        "properties": {
            "table_name": {
                "title": "Table Name",
                "description": "Name of the database table",
                "type": "string",
                "minLength": 1,
                "required": true
            },
            "display_name": {
                "title": "Display Label",
                "description": "Label used when displaying the table",
                "type": "string",
                "minLength": 1,
                "required": true
            },
            "item_name": {
                "title": "Item Label",
                "description": "Label used when referring to an item in the table",
                "type": "string",
                "minLength": 1,
                "required": true
            },
            "description": {
                "title": "Description",
                "description": "Descriptive text displayed when displaying the table",
                "type": "string",
                "required": true,
                "default": ""
            },
            "actions": {
                "title": "Allowed Actions to be performed on the table",
                "description": "Allowed actions to be performed on the table by default. Can be overriden by various plugin functions (see App Settings).",
                "type": "array",
                "uniqueItems": true,
                "required": true,
                "items": {
                    "title": "Allowed Action",
                    "type": "string",
                    "enum": [ "edit",  "new", "view", "list", "delete", "link", "merge" ]
                },
                "default": [ "edit",  "new", "view", "list", "delete", "link", "merge" ]
            },
            "hide_from_menu": {
                "title": "Suppress In Auto-Generated Menus",
                "description": "This list shall include all actions that identify the menu from which this table shall be hidden even if the action is allowed. Currently only menus for \"new\" and \"list\" actions are generated automatically, so these may be in the array",
                "type": "array",
                "uniqueItems": true,
                "required": true,
                "items": {
                    "title": "Allowed Action",
                    "type": "string",
                    "enum": [ "new", "list" ]
                }
            },
            "primary_key": {
                "title": "Primary Key",
                "description": "Primary key properties",
                "type": "object",
                "required": true,
                "properties": {
                    "auto": {
                        "title": "Auto Value?",
                        "description": "Is the table automatically set by the database, e.g. by a sequence or auto-increment value? If this is the case, you need to specify the Sequence Name below",
                        "type": "boolean",
                        "required": true
                    },
                    "columns": {
                        "title": "Columns",
                        "description": "List all columns that are part of the primary key",
                        "type": "array",
                        "format": "table",
                        "uniqueItems": true,
                        "minimum": 1,
                        "required": true,
                        "items": {
                            "title": "Primary Key Column",
                            "type": "string",
                            "required": true,
                            "minLength": 1
                        }
                    },
                    "sequence_name": {
                        "title": "Sequence Name",
                        "description": "If primary key values in this table are auto-generated by a sequence in PostgreSQL, specify the sequence name here. Otherwise, this setting is ignored.",
                        "type": "string",
                        "default": null,
                        "required": true
                    }
                }
            },
            "show_in_related": {
                "title": "Show Shortcut in Related Tables",
                "description": "In the record view page, there is a dropdown linking to tables where the current record is linked through a foreign key field. Specify whether your want this table to appear in this dropdown list.",
                "type": "boolean",
                "default": true,
                "required": true
            },
            "sort": {
                "title": "Default Sorting",
                "description": "Used for default sorting of the table in list mode. Provide an ordered array of columns with sort information",
                "type": "array",
                "required": false,
                "items": {
                    "title": "Sort Column",
                    "type": "object",
                    "properties": {
                        "column_name": {
                            "title": "Column Name",
                            "description": "Name of the column to sort",
                            "type": "string",
                            "minLength": 1,
                            "required": true
                        },
                        "sort_dir": {
                            "title": "Order",
                            "description": "Specify the order as ascending (<code>asc</code>) or descending (<code>desc</code>)",
                            "type": "string",
                            "enum": [ "asc", "desc" ],
                            "required": true
                        }
                    }
                }
            },
            "hooks": {
                "title": "Insert/Update Hooks",
                "description": "Functions to call before/after certain events. For <code>after_*</code> hooks, the arguments are: (1) table name (2) table settings and (3) primary key/value array; for <code>before_*</code> hooks the arguments are (1) table name (2) table settings (3) column names array reference, (4) column values array reference",
                "type": "array",
                "required": false,
                "items": {
                    "title": "Hook Function",
                    "type": "object",
                    "properties": {
                        "event": {
                            "title": "Event",
                            "description": "Event for which a hook function exists",
                            "type": "string",
                            "enum": [ "after_insert", "after_update", "before_insert", "before_update" ],
                            "required": true
                        },
                        "function": {
                            "title": "Function",
                            "description": "Name of the function to invoke for the event. ",
                            "type": "string",
                            "required": true,
                            "minLength": 1
                        }
                    }
                }
            },
            "additional_steps": {
                "title": "Linkage Shortcuts",
                "description": "Linkage shortcuts offered to be performed after a new record was created or a record is being viewed to link this record with others via separate linkage tables",
                "type": "array",
                "required": false,
                "items": {
                    "title": "Linkage Shortcut",
                    "type": "object",
                    "properties": {
                        "table_name": {
                            "title": "Table Name",
                            "description": "Name of the Linked Table",
                            "type": "string",
                            "minLength": 1,
                            "required": true
                        },
                        "shortcut": {
                            "title": "Shortcut Details",
                            "description": "Display and linkage details of the shortcut",
                            "type": "object",
                            "required": true,
                            "properties": {
                                "label": {
                                    "title": "Label",
                                    "description": "Label to be displayed in the shortcuts dropdown menu",
                                    "type": "string",
                                    "minLength": 1,
                                    "required": true
                                },
                                "foreign_key": {
                                    "title": "Foreign Key",
                                    "description": "Foreign key field in this database table",
                                    "type": "string",
                                    "minLength": 1,
                                    "required": true
                                }
                            }
                        }
                    }
                }
            },
            "custom_actions": {
                "title": "Custom Record Actions",
                "description": "Custom actions on records that are offered in particular viewing modes through particular icons, which will invoke a custom function. Parameters passed are: (1) name of the current table (2) table info object (3) the record retrieved from the database using <code>PDO::FETCH_ASSOC</code> and (4) this custom action object, which means that any additional key/value pairs you add to this array will get passed to the handler function. The expected return value of the handler function is a HTML string representing the icon to display for each record/row in the table.",
                "type": "array",
                "required": false,
                "items": {
                    "title": "Custom Action",
                    "type": "object",
                    "properties": {
                        "mode": {
                            "title": "View Mode",
                            "description": "View mode to which this custom action shall apply. Currently only the mode <code>list</code> is supported",
                            "type": "string",
                            "enum": [ "list" ],
                            "required": true
                        },
                        "handler": {
                            "title": "Handler Function",
                            "description": "Handler function to call for the custom action",
                            "type": "string",
                            "minLength": 1,
                            "required": true
                        }
                    }
                }
            },
            "render_links": {
                "title": "Render Links",
                "description": "If <code>link</code> and <code>list</code> actions are allowed in this table, then there will be an extra icon in the table in <code>list</code> view for each record that allows to view the actual object represented by the record (e.g. an image). Multiple such icons can be defined here.",
                "type": "array",
                "required": "optional",
                "items": {
                    "title": "Link",
                    "type": "object",
                    "properties": {
                        "icon": {
                            "title": "Icon",
                            "description": "The name of a glyphicon that works with bootstrap, e.g. <code>eye-open</code> or <code>trash</code>. See the <a target='_blank' href='http://www.w3schools.com/bootstrap/bootstrap_ref_comp_glyphs.asp'>full list here</a>",
                            "type": "string",
                            "minLength": 1,
                            "required": true
                        },
                        "href_format": {
                            "title": "Link Format",
                            "description": "A URL template that will be used in a <code>sprintf()</code> call, with the Field value (see below) as parameter. Therefore this string should contain one <code>%s</code>",
                            "type": "string",
                            "minLength": 1,
                            "required": true
                        },
                        "field": {
                            "title": "Field",
                            "description": "Name of the field whose value will be used to replace <code>%s</code> in the Link Format",
                            "type": "string",
                            "minLength": 1,
                            "required": true
                        },
                        "title": {
                            "title": "Tooltip",
                            "description": "Tooltip text shown when hovering the mouse cursor over the link icon",
                            "type": "string",
                            "minLength": 1,
                            "required": true
                        }
                    }
                }
            },
            "form_tabs": {
                "title": "Tabulated Forms",
                "description": "If tabbed record editing and viewing form is desired, these settings need to be filled.",
                "type": "object",
                "required": false,
                "properties": {
                    "tabs": {
                        "title": "Tabs",
                        "description": "Specify any number of tabs and their details",
                        "type": "array",
                        "minimum": 1,
                        "required": true,
                        "items": {
                            "title": "Tab",
                            "type": "object",
                            "properties": {
                                "id": {
                                    "title": "ID",
                                    "description": "Identifier of the tab, to be used in the 'tab' setting of the table's fields.",
                                    "type": "string",
                                    "minLength": 1,
                                    "required": true
                                },
                                "label": {
                                    "title": "Label",
                                    "description": "Label to display on the tab",
                                    "type": "string",
                                    "minLength": 1,
                                    "required": true
                                },
                                "intro": {
                                    "title": "Intro Text",
                                    "description": "If specified, any information (HTML encoded) that should be displayed at the top of the form tab",
                                    "type": "string",
                                    "required": false
                                }
                            }
                        }
                    },
                    "restrict_modes": {
                        "title": "Restricted Views",
                        "description": "By default, the tabs are shown on <code>new</code>, <code>edit</code>, and <code>view</code> forms. You may restrict the forms here",
                        "type": "array",
                        "uniqueItems": true,
                        "required": false,
                        "items": {
                            "title": "View",
                            "type": "string",
                            "enum": [ "edit",  "new", "view" ]
                        }
                    }
                }
            },
            "validation_func": {
                "title": "Form Validation Function",
                "description": "Allows naming a validation function that is invoked upon submission of the <code>new</code> and <code>edit</code> forms. This function needs to be implemented in JavaScript; the file in which it is implemented needs to be included via the <code>add_javascript()</code> helper function; the best place to do this in most circumstances is the <i>Preprocessing Function</i> defined in <i>App Settings</i>.<br>The function is called with three arguments: <ul><li><code>table_name</code>: string (the current table)</li><li><code>table_settings</code>: object (a JS object representing the table's settings from settings.php)</li><li><code>values</code>: object (for each column this object maps the column name to the value entered in the form)</li></ul>Expected return values are: if there are validation errors in the form, the function must return a JSON object that maps each erroneous form field to an error message to be displayed next to the form field; if there are no errors in the form, the function must return <code>null</code>",
                "type": "string",
                "required": false
            },
            "fields": {
                
            }
        }
    }
}
